Get-AppxPackage -AllUsers | Where-Object { ($_.IsFramework -eq $False) -and (!($_.packageFullName -like "Microsoft.StorePurchaseApp*")) -and (!($_.packageFullName -like "Microsoft.WindowsCalculator*")) -and (!($_.packageFullName -like "Microsoft.WindowsStore*")) } | Remove-AppxPackage -ErrorAction SilentlyContinue
Get-AppxProvisionedPackage -Online | Where-Object { (!($_.DisplayName -like "Microsoft.StorePurchaseApp*")) -and (!($_.DisplayName -like "Microsoft.WindowsCalculator*")) -and (!($_.DisplayName -like "Microsoft.WindowsStore*")) } | Remove-AppxProvisionedPackage -Online -ErrorAction SilentlyContinue