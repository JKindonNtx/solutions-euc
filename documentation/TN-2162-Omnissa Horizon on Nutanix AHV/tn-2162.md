# Executive Summary

This tech note discusses the supported scenarios to run Omnissa Horizon on Nutanix while running the native Nutanix hypervisor, AHV. Omnissa Horizon offers a digital workspace experience and it delivers virtual desktops and apps.

# Introduction

## Audience

This tech note is part of the Nutanix Solutions Library and provides an overview of the Omnissa Horizon on Nutanix solution. It's a technical introduction to the solution for IT architects and administrators.

## Purpose

This document covers the following topics:

- Nutanix Platform Overview
- Omnissa Horizon Platform Overview
- Omnissa Horizon on Nutanix AHV

This document describes what components of Omnissa Horizon are currently supported to run on Nutanix AHV.
Unless otherwise stated, the solution described in this document is valid on all supported AHV releases.

## Document Version History

| **Version Number** | **Published** | **Notes** |
| :---: | --- | --- |
| 1.0 | July 2024 | Original publication. |

# Nutanix Platform Overview

Nutanix designed its software to give customers running workloads in a hybrid cloud environment the same experience they expect from on-premises Nutanix clusters. Because Nutanix in a hybrid multicloud environment runs AOS and AHV with the same CLI, UI, and APIs, existing IT processes and third-party integrations continue to work regardless of where they run.

![Overview of the Nutanix Hybrid Multicloud Software](../images/TN-2162-Nutanix_Platform_Overview_image01.png "Overview of the Nutanix Hybrid Multicloud Software")

Nutanix AOS can withstand hardware failures and software glitches and ensures that application availability and performance are never compromised. Combining features like native rack awareness with public cloud partition placement groups, Nutanix operates freely in a dynamic hybrid multicloud environment.

# Omnissa Horizon Platform Overview

The Omnissa Horizon platform manages and delivers virtualized or hosted desktops and applications to end users. Horizon allows you to create and broker connections to Windows virtual desktops, Linux virtual desktops, Remote Desktop Server (RDS)â€“hosted applications and desktops, Linux-hosted applications, and Windows physical machines. Horizon is available as an on-premises datacenter solution and as a cloud based service, where Omnissa delivers and maintains all the critical management components.

Currently, only manual desktop pools are supported with Nutanix AHV as the hypervisor. Manual desktop pools are a collection of non-vCenter Windows or Linux virtual machines. For manual pools, Horizon does not create and manage the life cycle of the desktops in the pool. The desktops are created outside of Horizon and then imported into Horizon Console.

## Horizon Connection Servers on AHV
The Omnissa Horizon Connection server can be installed on a physical of virtual machine, as long as it meets the [recommended hardware specifications](https://docs.omnissa.com/bundle/Horizon8InstallUpgrade/page/HardwareRequirementsforHorizonConnectionServer.html). It is supported to run the Horizon Connection server on Nutanix AHV, if the virtual machine meets these requirements.

<note>
Do not migrate a virtual machine running the Horizon Connection server software from VMware ESXi to Nutanix AHV. This can result in users not being able to connect to their desktop. Instead, install a Horizon replica Connection server on a virtual machine running on AHV, then add it to the existing Horizon Pod. Once this Horizon replica server is confirmed to work correctly, it can be added to the load balancer. You can then remove one of the Horizon connection servers running on VMware ESXi. Repeat this until there are no more Horizon Connection servers on VMware ESXi.
</note>

## Virtual Appliances
Omnissa provides certain components as a virtual appliance like the Universal Access Gateway (UAG). Refer to the Omnissa documentation and download section to get the latest information about support for Nutanix AHV. It is not supported to install a virtual appliance on Nutanix AHV that is intended for a different virtualization platform. 

## Manual Pools
Omnissa Horizon currently supports manual pools on Nutanix AHV. This means that you can create virtual desktops or virtual servers on AHV and add these to a desktop pool in Omnissa Horizon. You can entitle active directory users or groups to logon to these virtual machines using the Horizon client. If you create virtual machines from a template or base image, the Horizon agent needs to be installed after the desktop or server has been generalized (sysprepped on Windows operating systems). This is required to be able to register the machines correctly in Horizon. The cloned virtual machines will copy properties from the template or base image, it is important to set these properties as you want them. Examples of these properties are virtual CPUs, memory allocation, disk size, vGPU assignment. The cloned machines will be persistent, so it is possible to change these properties after cloning (on a per virtual machine base).

### Virtual Desktops
You can add a desktop pool in Omnissa Horizon and choose type "Manual Desktop Pool" with Machine Source "Other sources". This allows you to select registered machines running on Nutanix AHV to include in the Virtual Desktop Pool. The User Assignment can still be "Floating", but it is recommended to use "Dedicated" assignment because of the persistency of the virtual machines. In most scenarios it's not desirable to have users logged on to virtual machines that potentially contain data from other users.

### Session Hosts
Before you create a desktop pool with RDS hosts, you first need to create a RDS Farm (manual farm) and add the registered RDS hosts to this farm. Then you are able to create a desktop pool or application pool and add the manual farm to this pool.

### Automation
The steps that are required to create the virtual machines, installing and registering the virtual machines to Horizon, and creating the manual desktop pool(s) can be automated using various tools. Nutanix AHV and Omnissa Horizon both provide a rest API to perform various tasks, like creating or cloning virtual machines, adding machines to Omnissa Horizon, assigning users to desktops or delete desktops. In the following table you can see examples of tools you can use to perform a certain task:

| **Task** | **Automation tool** |
| --- | --- | 
| Create golden image | Nutanix REST API, Microsoft Deployment Toolkit, Ansible | 
| Clone and sysprep virtual machines | Nutanix REST API |
| Install Horizon Agent and register to Horizon | Ansible, Microsoft Configuration Manager |
| Create Horizon Manual Pool | Omnissa Horizon REST API |
| Entitle User (Group) to the Manual Pool | Omnissa Horizon REST API |
| Add or remove User (Group) or Registered Machines | Omnissa Horizon REST API |

### Limitations
Running Horizon Agent in virtual machines on Nutanix AHV has the following limitations and known issues:
- No power actions (power on, power off, restart) available on virtual machines running on Nutanix AHV using the Horizon Console.
- There is currently no provisioning possible on Nutanix AHV from within the Horizon console. Virtual machines will need to be created manually.

# Conclusion



# Appendix

## References

1. [Horizon on Nutanix](http://portal.nutanix.com/kb/xxxx)
2. [Create Manual pools on Horizon](https://docs.omnissa.com/bundle/Desktops-and-Applications-in-HorizonV2312/page/CreateaManualDesktopPool.html)

